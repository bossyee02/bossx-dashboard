<canvas id="liveChart"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('liveChart').getContext('2d');

// batas atas & bawah
const upperLimit = 8;
const lowerLimit = 3;

// data awal
const data = {
  labels: Array.from({length: 50}, (_, i) => i),
  datasets: [{
    data: Array.from({length: 50}, () => Math.random() * 10),
    borderWidth: 2,
    fill: false,
    tension: 0.4,
    pointRadius: 0,
    segment: {
      borderColor: ctx => {
        const value = ctx.p1.parsed.y;
        if (value >= upperLimit) return 'blue';
        if (value <= lowerLimit) return 'red';
        return 'lime'; // normal zone
      }
    }
  }]
};

const chart = new Chart(ctx, {
  type: 'line',
  data,
  options: {
    animation: false,
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      x: { display: false },
      y: { min: 0, max: 10 }
    },
    plugins: {
      legend: { display: false },
      annotation: {
        annotations: {
          upper: { type: 'line', yMin: upperLimit, yMax: upperLimit, borderColor: 'blue', borderWidth: 1 },
          lower: { type: 'line', yMin: lowerLimit, yMax: lowerLimit, borderColor: 'red', borderWidth: 1 }
        }
      }
    }
  },
  plugins: [Chart.registry.getPlugin('annotation')]
});

// update otomatis
setInterval(() => {
  data.labels.push(data.labels.length);
  data.labels.shift();
  data.datasets[0].data.push(Math.random() * 10); // nilai baru
  data.datasets[0].data.shift();
  chart.update();
}, 500);
</script>
